import pandas as pd

# 상세 기능 명세서를 구조화된 데이터로 변환
detailed_data = [
    # 1. 로그인
    {"대분류": "1. 로그인", "중분류": "1-1. ID/PW 로그인", "소분류": "", "기능명": "기본 로그인", "상세 내용": "사용자명/이메일과 비밀번호를 통한 인증"},
    {"대분류": "1. 로그인", "중분류": "1-1. ID/PW 로그인", "소분류": "", "기능명": "로그인 실패 처리", "상세 내용": "3회 연속 실패 시 계정 임시 잠금(5분), 실패 사유별 상세 메시지 제공"},
    {"대분류": "1. 로그인", "중분류": "1-1. ID/PW 로그인", "소분류": "1-1-1. 비밀번호 찾기", "기능명": "이메일 인증", "상세 내용": "등록된 이메일로 임시 비밀번호 발송"},
    {"대분류": "1. 로그인", "중분류": "1-1. ID/PW 로그인", "소분류": "1-1-1. 비밀번호 찾기", "기능명": "관리자 승인", "상세 내용": "관리자가 직접 비밀번호 재설정 후 사용자에게 전달"},
    {"대분류": "1. 로그인", "중분류": "1-2. 통합 인증", "소분류": "", "기능명": "SSO 연동", "상세 내용": "SAML 2.0, OAuth 2.0 지원"},
    {"대분류": "1. 로그인", "중분류": "1-2. 통합 인증", "소분류": "", "기능명": "LDAP 연동", "상세 내용": "Active Directory 및 OpenLDAP 지원"},
    {"대분류": "1. 로그인", "중분류": "1-2. 통합 인증", "소분류": "", "기능명": "NAC 연동", "상세 내용": "네트워크 접근 제어 시스템과 연동하여 인증된 디바이스만 접근 허용"},
    {"대분류": "1. 로그인", "중분류": "1-3. 회원가입 기능 없음", "소분류": "", "기능명": "관리자 전용 등록", "상세 내용": "모든 사용자는 관리자가 직접 등록"},
    
    # 2. 세션관리
    {"대분류": "2. 세션관리", "중분류": "2-1. 로그아웃", "소분류": "", "기능명": "수동 로그아웃", "상세 내용": "상단 메뉴바의 사용자 프로필 > 로그아웃"},
    {"대분류": "2. 세션관리", "중분류": "2-1. 로그아웃", "소분류": "", "기능명": "확인 모달", "상세 내용": "저장되지 않은 작업이 있을 경우 경고 메시지"},
    {"대분류": "2. 세션관리", "중분류": "2-2. 세션 타임아웃", "소분류": "", "기능명": "비활성 시간 설정", "상세 내용": "관리자가 15분~8시간 범위에서 설정 가능"},
    {"대분류": "2. 세션관리", "중분류": "2-2. 세션 타임아웃", "소분류": "", "기능명": "경고 알림", "상세 내용": "만료 5분 전 연장 여부 확인 팝업"},
    
    # 3. 예외/에러 페이지
    {"대분류": "3. 예외/에러 페이지", "중분류": "3-1. 404, 500 페이지", "소분류": "", "기능명": "404 페이지", "상세 내용": "요청한 페이지를 찾을 수 없음, 홈으로 돌아가기 버튼 제공"},
    {"대분류": "3. 예외/에러 페이지", "중분류": "3-1. 404, 500 페이지", "소분류": "", "기능명": "500 페이지", "상세 내용": "서버 내부 오류, 관리자 연락처 및 오류 신고 기능"},
    {"대분류": "3. 예외/에러 페이지", "중분류": "3-1. 404, 500 페이지", "소분류": "", "기능명": "403 페이지", "상세 내용": "접근 권한 없음, 권한 요청 기능"},
    
    # 4. 사용자 관리
    {"대분류": "4. 사용자 관리", "중분류": "4-1. 사용자 등록 및 수정", "소분류": "", "기능명": "사용자 정보", "상세 내용": "이름, 이메일, 부서, 직급, 연락처, 권한 그룹"},
    {"대분류": "4. 사용자 관리", "중분류": "4-1. 사용자 등록 및 수정", "소분류": "", "기능명": "일괄 등록", "상세 내용": "CSV/Excel 파일을 통한 대량 사용자 등록"},
    {"대분류": "4. 사용자 관리", "중분류": "4-1. 사용자 등록 및 수정", "소분류": "", "기능명": "상태 관리", "상세 내용": "활성/비활성/임시정지 상태 설정"},
    {"대분류": "4. 사용자 관리", "중분류": "4-2. 사용자 권한 보기", "소분류": "", "기능명": "권한 매트릭스", "상세 내용": "사용자별 기능 접근 권한 시각화"},
    {"대분류": "4. 사용자 관리", "중분류": "4-2. 사용자 권한 보기", "소분류": "", "기능명": "소속 팀 정보", "상세 내용": "팀 구조 및 역할 정보 표시"},
    
    # 5. 환경설정
    {"대분류": "5. 환경설정", "중분류": "5-1. 권한 그룹 관리", "소분류": "", "기능명": "기본 권한 그룹", "상세 내용": "관리자, 분석가, 뷰어, 게스트"},
    {"대분류": "5. 환경설정", "중분류": "5-1. 권한 그룹 관리", "소분류": "", "기능명": "커스텀 권한", "상세 내용": "세부 기능별 권한 조합 생성"},
    {"대분류": "5. 환경설정", "중분류": "5-1. 권한 그룹 관리", "소분류": "", "기능명": "권한 상속", "상세 내용": "상위 권한 그룹의 권한 자동 상속"},
    
    # 6. 분석결과
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "", "기능명": "필터링", "상세 내용": "날짜, 프로젝트, 심각도, 상태별 필터"},
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "", "기능명": "정렬", "상세 내용": "날짜, 심각도, 프로젝트명 등 다중 정렬 지원"},
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "6-1-1. 분석 상세 리스트 보기", "기능명": "취약점 정보", "상세 내용": "CVE 번호, CVSS 점수, 영향도, 해결 방안"},
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "6-1-1. 분석 상세 리스트 보기", "기능명": "라이선스 정보", "상세 내용": "라이선스 유형, 호환성, 의무사항"},
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "6-1-2. 내보내기", "기능명": "PDF", "상세 내용": "경영진 보고용 요약 리포트"},
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "6-1-2. 내보내기", "기능명": "Excel", "상세 내용": "상세 데이터 분석용 스프레드시트"},
    {"대분류": "6. 분석결과", "중분류": "6-1. 분석결과 리스트", "소분류": "6-1-2. 내보내기", "기능명": "SPDX", "상세 내용": "표준 SBOM 형식으로 내보내기"},
    
    # 7. 프로젝트
    {"대분류": "7. 프로젝트", "중분류": "7-1. 프로젝트", "소분류": "7-1-1. 프로젝트 설정 모달", "기능명": "기본 정보", "상세 내용": "프로젝트명, 설명, 담당자, 생성일"},
    {"대분류": "7. 프로젝트", "중분류": "7-1. 프로젝트", "소분류": "7-1-1. 프로젝트 설정 모달", "기능명": "저장소 연동", "상세 내용": "Git 저장소 URL, 브랜치 설정"},
    {"대분류": "7. 프로젝트", "중분류": "7-2. 프로젝트 리스트", "소분류": "", "기능명": "카드뷰/리스트뷰", "상세 내용": "사용자 선호에 따른 표시 방식 선택"},
    {"대분류": "7. 프로젝트", "중분류": "7-2. 프로젝트 리스트", "소분류": "7-2-1. 프로젝트 클릭", "기능명": "대시보드", "상세 내용": "취약점 현황, 라이선스 분포, 컴포넌트 통계"},
    {"대분류": "7. 프로젝트", "중분류": "7-2. 프로젝트 리스트", "소분류": "7-2-2. 프로젝트 버전 관리", "기능명": "버전 태깅", "상세 내용": "주요 릴리즈 버전 태그 설정"},
    {"대분류": "7. 프로젝트", "중분류": "7-2. 프로젝트 리스트", "소분류": "7-2-3. 프로젝트 변경 이력 관리", "기능명": "SBOM 비교", "상세 내용": "버전 간 컴포넌트 변경사항 비교"},
    {"대분류": "7. 프로젝트", "중분류": "7-3. 정책 관리", "소분류": "", "기능명": "스캔 정책", "상세 내용": "스캔 주기, 대상 파일 유형, 깊이 설정"},
    {"대분류": "7. 프로젝트", "중분류": "7-3. 정책 관리", "소분류": "7-3-1. 오픈소스 취약점 정책 관리", "기능명": "허용 목록", "상세 내용": "조직에서 승인된 안전한 컴포넌트 목록"},
    {"대분류": "7. 프로젝트", "중분류": "7-3. 정책 관리", "소분류": "7-3-2. 라이센스 위반 정책 관리", "기능명": "라이선스 화이트리스트", "상세 내용": "사용 허용 라이선스 목록"},
    
    # 8. 알림 및 감사 로그
    {"대분류": "8. 알림 및 감사 로그", "중분류": "8-1. 주요 이벤트 알림", "소분류": "", "기능명": "실시간 알림", "상세 내용": "웹 브라우저 푸시 알림"},
    {"대분류": "8. 알림 및 감사 로그", "중분류": "8-1. 주요 이벤트 알림", "소분류": "", "기능명": "이메일 알림", "상세 내용": "중요 이벤트 발생 시 이메일 발송"},
    {"대분류": "8. 알림 및 감사 로그", "중분류": "8-1. 주요 이벤트 알림", "소분류": "", "기능명": "Slack/Teams 연동", "상세 내용": "팀 협업 도구와 연동한 알림"},
    {"대분류": "8. 알림 및 감사 로그", "중분류": "8-2. 감사 로그", "소분류": "", "기능명": "활동 추적", "상세 내용": "모든 사용자 활동 상세 기록"},
    {"대분류": "8. 알림 및 감사 로그", "중분류": "8-2. 감사 로그", "소분류": "", "기능명": "로그 보존", "상세 내용": "설정 가능한 로그 보존 기간 (1개월~5년)"},
    {"대분류": "8. 알림 및 감사 로그", "중분류": "8-2. 감사 로그", "소분류": "", "기능명": "규정 준수", "상세 내용": "SOX, GDPR 등 규정 준수를 위한 로그 관리"}
]

# 데이터프레임 생성
df_detailed = pd.DataFrame(detailed_data)

# 엑셀 파일로 저장
excel_filename = "시스템_기능명세서_상세.xlsx"
with pd.ExcelWriter(excel_filename, engine='openpyxl') as writer:
    df_detailed.to_excel(writer, sheet_name='상세 기능 명세서', index=False)

print(f"엑셀 파일이 생성되었습니다: {excel_filename}")
print(f"총 {len(df_detailed)} 개의 기능이 포함되어 있습니다.")

# 데이터 미리보기
df_detailed.head(10)
